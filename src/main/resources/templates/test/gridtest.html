<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Script-Type" content="text/javascript">
    <meta http-equiv="Content-Style-Type" content="text/css">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta name="viewport" content="width=800">
    <meta name="og:title" content="HTML5, 자바스크립트 데이터그리드 AUIGrid">
    <meta name="og:url" content="http://www.auisoft.net/">
    <meta name="og:description" content="HTML5, 자바스크립트 데이타그리드(javascript datagrid) AUISoft">
    <title>세탁접수테스트</title>
<!--    <link href="http://www.auisoft.net/aui.ico" rel="shortcut icon" />-->

<!--    &lt;!&ndash; 데모 구성용 CSS 입니다. 실제 프로젝트에서는 불필요 하니 추가할 필요 없습니다. &ndash;&gt;-->
<!--    <link href="/assets/js/AUIGrid/demo.css" rel="stylesheet">-->

    <!-- ajax 요청을 위한 스크립트입니다. -->
    <!-- jQuery 사용한다면, 해당 2개의 JS는 불필요 합니다.  -->
    <script type="text/javascript"	src="/assets/js/jquery.min.js"></script>
<!--    <script type="text/javascript" src="/assets/AUIGrid/ajax.js"></script>-->
<!--    <script type="text/javascript" src="/assets/AUIGrid/common.js"></script>-->

    <!-- AUIGrid 테마 CSS 파일입니다. 그리드 출력을 위해 꼭 삽입하십시오. -->
    <!-- 원하는 테마가 있다면, 다른 파일로 교체 하십시오. -->
    <link href="/assets/js/AUIGrid/AUIGrid_style.css" rel="stylesheet">

    <!-- AUIGrid 라이센스 파일입니다. 그리드 출력을 위해 꼭 삽입하십시오. -->
    <script type="text/javascript" src="/assets/js/AUIGrid/AUIGridLicense.js"></script>

    <!-- 실제적인 AUIGrid 라이브러리입니다. 그리드 출력을 위해 꼭 삽입하십시오.-->
    <script type="text/javascript" src="/assets/js/AUIGrid/AUIGrid.js"></script>

    <style type="text/css">

        /* 커스텀 칼럼 스타일 정의 */
        .my-column {
            text-align:right;
        }
    </style>
    <script type="text/javascript">


        // AUIGrid 생성 후 반환 ID
        var myGridID;
        var myGridID2;

        // document ready (jQuery 의 $(document).ready(function() {}); 과 같은 역할을 합니다.
        $( document ).ready(function() {
            // Member 도메인(VO) 로 서버 사이드에서 처리하는 요청
            $("#btn2").click(function(){
                updateDataToServer("./saveDomain");
            });


            // AUIGrid 그리드를 생성합니다.
            createAUIGrid(columnLayout);

            // JS Array 를 그리드에 삽입
            //AUIGrid.setGridData(myGridID, myData);
            AUIGrid.setGridData(myGridID2, myData);

        });
        // function documentReady() {
        //
        //
        // };

        //AUIGrid 칼럼 설정
        //데이터 형태는 다음과 같은 형태임,
        //[{"id":"#Cust0","date":"2014-09-03","name":"Han","country":"USA","product":"Apple","color":"Red","price":746400}, { .....} ];
        var columnLayout2 = [ {
            dataField : "code",
            headerText : "코드",
            editable : false,
            width : 120
        }, {
            dataField : "name",
            headerText : "상품명",
            editable : false,
            width : 120
        }, {
            dataField : "price",
            headerText : "일반가격",
            dataType : "numeric",
            style : "my-column",
            editable : true,
            width : 120,
            editRenderer : {
                type : "InputEditRenderer",
                onlyNumeric : true, // 0~9만 입력가능
                textAlign : "right", // 오른쪽 정렬로 입력되도록 설정
                autoThousandSeparator : true // 천단위 구분자 삽입 여부
            }
        },{
            dataField : "price2",
            headerText : "고급가격",
            dataType : "numeric",
            style : "my-column",
            editable : false,
            width : 120

        }, {
            dataField : "etc", // 임의의 고유값
            headerText : "Etc",
            editable : false,
            width: 140,
            headerTooltip : {
                show : true,
                tooltipHtml : "Name 이 Anna 인 경우 버튼 표시하지 않음"
            },
            renderer : {
                type : "ButtonRenderer",
                labelText : "세탁물선택",
                onClick : function(event) {
                    addRow(event.item.name);
                    //alert("( " + event.rowIndex + ", " + event.columnIndex + " ) " + event.item.name + " 선택 클릭");
                },
                visibleFunction :  function(rowIndex, columnIndex, value, item, dataField ) {
                    // 행 아이템의 name 이 Anna 라면 버튼 표시 하지 않음
                    if(item.name == "Anna") {
                        return false;
                    }
                    return true;
                }
            }
        }];

        var columnLayout = [ {
            dataField : "id",
            headerText : "ID",

            width : 120
        }, {
            dataField : "name",
            headerText : "Name",
            editable : true,
            width : 140
        }, {
            dataField: "country",
            headerText: "Country",
            editable : true,
            width: 120
        }, {
            dataField : "price",
            headerText : "Price",
            dataType : "numeric",
            style : "my-column",
            editable : true,
            width : 120,
            editRenderer : {
                type : "InputEditRenderer",
                onlyNumeric : true, // 0~9만 입력가능
                textAlign : "right", // 오른쪽 정렬로 입력되도록 설정
                autoThousandSeparator : true // 천단위 구분자 삽입 여부
            }
        }, {
            dataField : "emergency",
            headerText : "긴급여부",
            width: 120,
            renderer : {
                type : "CheckBoxEditRenderer",
                showLabel : true, // 참, 거짓 텍스트 출력여부( 기본값 false )
                editable : true // 체크박스 편집 활성화 여부(기본값 : false)
            }
        }, {
            dataField : "etc", // 임의의 고유값
            headerText : "Etc",
            width: 140,
            headerTooltip : {
                show : true,
                tooltipHtml : "Name 이 Anna 인 경우 버튼 표시하지 않음"
            },
            renderer : {
                type : "ButtonRenderer",
                labelText : "세탁물선택",
                onClick : function(event) {

                    alert("( " + event.rowIndex + ", " + event.columnIndex + " ) " + event.item.name + " 선택 클릭2");
                },
                visibleFunction :  function(rowIndex, columnIndex, value, item, dataField ) {
                    // 행 아이템의 name 이 Anna 라면 버튼 표시 하지 않음
                    if(item.name == "Anna") {
                        return false;
                    }
                    return true;
                }
            }
        }];

        // AUIGrid 를 생성합니다.
        function createAUIGrid(columnLayout) {

            // 그리드 속성 설정
            var gridPros = {

                // 편집 가능 여부 (기본값 : false)

                editable : true,


                // 엔터키가 다음 행이 아닌 다음 칼럼으로 이동할지 여부 (기본값 : false)
                enterKeyColumnBase : true,

                // 셀 선택모드 (기본값: singleCell)
                selectionMode : "multipleCells",

                // 컨텍스트 메뉴 사용 여부 (기본값 : false)
                useContextMenu : true,

                // 필터 사용 여부 (기본값 : false)
                enableFilter : true,

                // 그룹핑 패널 사용
                useGroupingPanel : true,

                // 상태 칼럼 사용
                showStateColumn : true,

                // 그룹핑 또는 트리로 만들었을 때 펼쳐지게 할지 여부 (기본값 : false)
                displayTreeOpen : true,

                noDataMessage : "출력할 데이터가 없습니다.",

                groupingMessage : "여기에 칼럼을 드래그하면 그룹핑이 됩니다."
            };

            // 실제로 #grid_wrap 에 그리드 생성
            myGridID = AUIGrid.create("#grid_wrap", columnLayout, gridPros);
            // 행 추가 이벤트 바인딩
            AUIGrid.bind(myGridID, "addRow", auiAddRowHandler);

            myGridID2 = AUIGrid.create("#grid_wrap2", columnLayout2, gridPros);
        }


        // 서버 사이드에서 매핑한 데이터
        var myData = [{
            "code": "A0001",
            "name": "(남)정장상의",
            "price": 3300,
            "price2": 5300
        },{
            "code": "A0002",
            "name": "(남)자켓상의",
            "price": 4300,
            "price2": 5300
        },{
            "code": "A0005",
            "name": "(남)니트상의",
            "price": 2300,
            "price2": 4300
        }];

        function updateDataToServer( url ) {

            // 추가된 행 아이템들(배열)
            var addList = AUIGrid.getAddedRowItems(myGridID);
            // 수정된 행 아이템들(배열)
            var updateList = AUIGrid.getEditedRowColumnItems(myGridID);
            // 삭제된 행 아이템들(배열)
            var removeList = AUIGrid.getRemovedItems(myGridID);

            var data = {};

            if(addList.length > 0) data.add = addList;
            else data.add = [];

            if(updateList.length > 0) data.update = updateList;
            else data.update = [];

            if(removeList.length > 0) data.remove = removeList;
            else data.remove = [];
            // alert(updateList.length);
            alert(updateList[0]["name"]);

        }
        // 행 추가 이벤트 핸들러
        function auiAddRowHandler(event) {
            //alert(event.type + " 이벤트\r\n" + "삽입된 행 인덱스 : " + event.rowIndex + "\r\n삽입된 행 개수 : " + event.items.length);
            //document.getElementById("rowInfo").innerHTML = (event.type + " 이벤트 :  " + "삽입된 행 인덱스 : " + event.rowIndex + ", 삽입된 행 개수 : " + event.items.length);
        };

        // 행 추가, 삽입
        function addRow(name) {


            var rowPos ="last";// document.getElementById("addSelect").value;

            var item = new Object();
            item.name = name;


            // parameter
            // item : 삽입하고자 하는 아이템 Object 또는 배열(배열인 경우 다수가 삽입됨)
            // rowPos : rowIndex 인 경우 해당 index 에 삽입, first : 최상단, last : 최하단, selectionUp : 선택된 곳 위, selectionDown : 선택된 곳 아래
            AUIGrid.addRow(myGridID, item, rowPos);
        };

    </script>

</head>
<body>

<div id="main">
    <div class="desc">
        <p>AUI 그리드 테스트</p>

    </div>
    <div>
        <!-- 에이유아이 그리드가 이곳에 생성됩니다. -->
        <div id="grid_wrap" style="width:1200px; height:280px; margin:0 auto;"></div>

    </div>
    <div>
        <!-- 에이유아이 그리드가 이곳에 생성됩니다. -->
        <div id="grid_wrap2" style="width:1200px; height:220px; margin:0 auto;"></div>

    </div>
    <div class="desc_bottom">
        <p id="ellapse"></p>

    </div>
</div>
    <button id="btn2">요청하기(도메인 객체)</button>
<div id="footer">
    <div class="copyright">
        <p>Copyright ©2021 AUISoft </p>
    </div>

</div>

</body>
</html>