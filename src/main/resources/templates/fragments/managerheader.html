<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<header th:fragment="headerFragment" class="header">
	<div class="header__inner">
		<div class="logo">
			<a href="/manager"><img src="/assets/images/logo.svg" alt="TopPos Cleaning Up Megashop" /></a>
		</div>

		<nav class="n-gnb">
			<ul class="n-gnb__list">
				<li class="n-gnb__item">
					<a href="#" class="n-gnb__depth1">출고 관리</a>
					<div class="n-gnb__dim">
						<div class="n-gnb__group">
							<h4 class="n-gnb__title">출고 관리</h4>
							<ul class="n-gnb__depth2">
								<li><a href="/manager/release" class="n-gnb__link">지사 출고</a></li>
								<li><a href="/manager/releasecancel" class="n-gnb__link">지사 출고 취소</a></li>
							</ul>
						</div>
					</div>
				</li>
				<li class="n-gnb__item">
					<a href="#" class="n-gnb__depth1">반송 / 검품</a>
					<div class="n-gnb__dim">
						<div class="n-gnb__group">
							<h4 class="n-gnb__title">반송 / 검품</h4>
							<ul class="n-gnb__depth2">
								<li><a href="/manager/forcerelease" class="n-gnb__link">강제 출고</a></li>
								<li><a href="/manager/returnrelease" class="n-gnb__link">반품 출고</a></li>
								<li><a href="/manager/checkregist" class="n-gnb__link">확인품 등록</a></li>
								<li><a href="/manager/checkstate" class="n-gnb__link">확인품 현황</a></li>
							</ul>
						</div>
					</div>
				</li>
				<li class="n-gnb__item">
					<a href="#" class="n-gnb__depth1">입출고현황</a>
					<div class="n-gnb__dim">
						<div class="n-gnb__group">
							<h4 class="n-gnb__title">입출고현황</h4>
							<ul class="n-gnb__depth2">
								<li><a href="/manager/receptionstate" class="n-gnb__link">실시간 접수 현황</a></li>
								<li><a href="/manager/tag" class="n-gnb__link">TAG 번호 조회</a></li>
								<li><a href="/manager/instate" class="n-gnb__link">지사 입고 현황</a></li>
								<li><a href="/manager/outstate" class="n-gnb__link">지사 출고 현황</a></li>
								<li><a href="/manager/forceoutstate" class="n-gnb__link">강제 출고 현황(지사)</a></li>
								<li><a href="/manager/forcestorestat" class="n-gnb__link">강제 입고 현황(가맹)</a></li>
								<li><a href="/manager/notrelease" class="n-gnb__link">미출고현황</a></li>
								<li><a href="/manager/staystate" class="n-gnb__link">체류 세탁물 현황</a></li>
								<li><a href="/manager/retrystat" class="n-gnb__link">재세탁 입고 현황</a></li>
								<li><a href="/manager/refundstat" class="n-gnb__link">반품 현황</a></li>
								<li><a href="/manager/highspeedsuperspecialstat" class="n-gnb__link">초특급세탁 처리 현황</a></li>
								<li><a href="/manager/highspeedspecialstat" class="n-gnb__link">특급세탁 처리 현황</a></li>
								<li><a href="/manager/highspeedstat" class="n-gnb__link">급세탁 처리 현황</a></li>
								<li><a href="/manager/normalspeedstat" class="n-gnb__link">일반 처리 현황</a></li>
								<li><a href="/manager/qrhistory" class="n-gnb__link">QR 스캔 이력</a></li>
							</ul>
						</div>
					</div>
				</li>
				<li class="n-gnb__item">
					<a href="#" class="n-gnb__depth1">정산현황</a>
					<div class="n-gnb__dim">
						<div class="n-gnb__group">
							<h4 class="n-gnb__title">본사/지사간 정산현황</h4>
							<ul class="n-gnb__depth2">
								<li><a href="/manager/brmonthbalance" class="n-gnb__link">지사 월 정산 내역</a></li>
								<li><a href="/manager/brmonthdepositstatus" class="n-gnb__link">지사 월 정산 입금 현황</a></li>
							</ul>
						</div>
						<div class="n-gnb__group">
							<h4 class="n-gnb__title">지사/가맹점간 정산 현황</h4>
							<ul class="n-gnb__depth2">
								<li><a href="/manager/frdaybalance" class="n-gnb__link">가맹점 일 정산 내역</a></li>
								<li><a href="/manager/frdaydepositstatus" class="n-gnb__link">가맹점 일 정산 입금 현황</a></li>
								<li><a href="/manager/frdaydeposit" class="n-gnb__link">가맹점 일 정산 입금 등록</a></li>
							</ul>
						</div>
					</div>
				</li>
				<li class="n-gnb__item">
					<a href="#" class="n-gnb__depth1">외주관리</a>
					<div class="n-gnb__dim">
						<div class="n-gnb__group">
							<h4 class="n-gnb__title">외주관리</h4>
							<ul class="n-gnb__depth2">
								<li><a href="/manager/ospricemanage" class="n-gnb__link">외주관리가격설정</a></li>
								<li><a href="/manager/ossend" class="n-gnb__link">외주출고처리</a></li>
								<li><a href="/manager/osreceive" class="n-gnb__link">외주입고처리</a></li>
								<li><a href="/manager/osstatus" class="n-gnb__link">외주입출고현황</a></li>
							</ul>
						</div>
					</div>
				</li>
				<li class="n-gnb__item">
					<a href="#" class="n-gnb__depth1">설정</a>
					<div class="n-gnb__dim">
						<div class="n-gnb__group">
							<h4 class="n-gnb__title">설정</h4>
							<ul class="n-gnb__depth2">
								<li><a href="/manager/mypage" class="n-gnb__link">나의 정보 관리</a></li>
								<li><a href="/manager/businessday" class="n-gnb__link">영업일 관리</a></li>
								<li><a href="/manager/noticelist" class="n-gnb__link">공지사항 게시판</a></li>
								<li><a href="/manager/tagboard" class="n-gnb__link">TAG 분실 게시판</a></li>
								<li><a href="/manager/find" class="n-gnb__link">물건찾기</a></li>
								<li><a href="/manager/message" class="n-gnb__link">문자메세지</a></li>
							</ul>
						</div>
					</div>
				</li>
			</ul>
		</nav>
	
		<div class="info" id="logout_Form">
			<div class="info__user">
				<span class="info__icon">user image</span>
				<span id="headerUserInfo" class="info__user-name">고양지사 - 홍길동</span>
			</div>
			<button class="header__btn" onclick="logout()">
				<img src="/assets/images/icon__logout--g.svg" alt="로그아웃" /><span>로그아웃</span>
			</button>
		</div>
	</div>
	<div class="gnb__layer"></div>
	<script type="text/javascript">


		$(document).ready(function() {
			CommonUI.ajax("/api/manager/branchHeaderData", "GET", false, function (res) {
				const data = res.sendData;
				$("#headerUserInfo").html(data.accountHeaderData.brName + " - " + data.accountHeaderData.username);
			});

			try {
				const token = window.localStorage.getItem('Authorization');
				const parsedToken = readToken(token);
				const authorization = parsedToken.auth;
				manageSubmenuOnOff(authorization);
			} catch (e) {
				console.log(e);
			}
		});

		function readToken (token) {
			let base64 = token.split('.')[1].replace(/-/g, '+').replace(/_/g, '/');
			return JSON.parse(decodeURIComponent(atob(base64).split('').map(function(c) {
				return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
			}).join('')));
		}

		/* 관리자 권한을 바탕으로 메뉴 show hide */
		function manageSubmenuOnOff(authorization) {
			/* ROLE_NORMAL가 접근 불가능한 페이지의 리스트, "find", "message" 하는 방식으로 기술할 것 */
			const normalRestrictPage = [

			]
			if (authorization === "ROLE_MANAGER") {
				$(".btnSubmenu").show();
			} else if (authorization === "ROLE_NORMAL") {
				for(const pageName of normalRestrictPage) {
					$(`a[href="/manager/${pageName}"]`).hide();
				}
			} else {
				$(".btnSubmenu").hide();
			}
		}
	</script>
</header>


</html>
